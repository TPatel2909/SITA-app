<!-- Performance Agreement Form -->
<div class="performance-container">
  <form [formGroup]="agreementForm" (ngSubmit)="onSubmit()">
    <!-- Header Section -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>Performance Agreement</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <!-- Employer Details -->
        <section formGroupName="employerDetails">
          <h3>Employer Details</h3>
          <div class="form-row">
            <mat-form-field>
              <mat-label>Department Name</mat-label>
              <input matInput formControlName="departmentName">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Branch Name</mat-label>
              <input matInput formControlName="branchName">
            </mat-form-field>
          </div>
        </section>

        <!-- Employee Details -->
        <section formGroupName="employeeDetails">
          <h3>Employee Details</h3>
          <div class="form-row">
            <mat-form-field>
              <mat-label>Full Name</mat-label>
              <input matInput formControlName="fullName">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Employee Number</mat-label>
              <input matInput formControlName="employeeNumber">
            </mat-form-field>
          </div>
          <div class="form-row">
            <mat-form-field>
              <mat-label>Job Title</mat-label>
              <input matInput formControlName="jobTitle">
            </mat-form-field>
            <mat-form-field>
              <mat-label>Salary Level</mat-label>
              <input matInput formControlName="salaryLevel">
            </mat-form-field>
          </div>
        </section>

        <!-- Agreement Terms -->
        <section formGroupName="agreementTerms">
          <h3>Agreement Terms</h3>
          <div class="form-row">
            <mat-form-field>
              <mat-label>Start Date</mat-label>
              <input matInput [matDatepicker]="startPicker" formControlName="startDate">
              <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
              <mat-datepicker #startPicker></mat-datepicker>
            </mat-form-field>
            <mat-form-field>
              <mat-label>End Date</mat-label>
              <input matInput [matDatepicker]="endPicker" formControlName="endDate">
              <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
              <mat-datepicker #endPicker></mat-datepicker>
            </mat-form-field>
          </div>
        </section>

        <!-- Key Result Areas -->
        <section formArrayName="keyResultAreas">
          <h3>Key Result Areas (KRAs)</h3>
          <div *ngFor="let kra of getKRAs().controls; let i = index" [formGroupName]="i" class="kra-section">
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>KRA Description</mat-label>
                <textarea matInput formControlName="description" rows="3"></textarea>
              </mat-form-field>
            </div>
            <div class="form-row">
              <mat-form-field>
                <mat-label>Weight (%)</mat-label>
                <input matInput type="number" formControlName="weight" min="0" max="100">
              </mat-form-field>
            </div>
            <button mat-icon-button color="warn" type="button" (click)="removeKRA(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
          <button mat-raised-button type="button" (click)="addKRA()">
            <mat-icon>add</mat-icon> Add KRA
          </button>
        </section>

        <!-- Generic Assessment Factors -->
        <section formArrayName="genericAssessmentFactors">
          <h3>Generic Assessment Factors (GAFs)</h3>
          <div *ngFor="let gaf of getGAFs().controls; let i = index" [formGroupName]="i" class="gaf-section">
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Factor</mat-label>
                <input matInput formControlName="factor">
              </mat-form-field>
            </div>
            <div class="form-row">
              <mat-form-field class="full-width">
                <mat-label>Description</mat-label>
                <textarea matInput formControlName="description" rows="3"></textarea>
              </mat-form-field>
            </div>
            <button mat-icon-button color="warn" type="button" (click)="removeGAF(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </div>
          <button mat-raised-button type="button" (click)="addGAF()">
            <mat-icon>add</mat-icon> Add GAF
          </button>
        </section>
      </mat-card-content>

      <!-- Form Actions -->
      <mat-card-actions align="end">
        <button mat-button type="button" (click)="saveDraft()">Save Draft</button>
        <button mat-raised-button color="primary" type="submit" [disabled]="!agreementForm.valid">Submit</button>
      </mat-card-actions>
    </mat-card>
  </form>
</div> 